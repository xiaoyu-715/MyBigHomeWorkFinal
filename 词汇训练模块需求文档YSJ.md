# 词汇训练模块需求文档

## 1. 项目概述

### 1.1 项目目标
将所有与词汇学习相关的功能统一整合到词汇训练模块中,提供完整的词汇学习体验,包括词书选择、单词学习、进度追踪等功能。

### 1.2 核心价值
- **统一入口**: 所有词汇学习功能集中在一个模块
- **灵活选择**: 用户可自由选择词书进行学习
- **进度同步**: 与今日任务和学习计划无缝集成
- **完整体验**: 提供单词显示、发音、测试、统计等完整功能

## 2. 功能需求

### 2.1 词书选择功能

#### 2.1.1 词书列表展示
- **需求描述**: 用户进入词汇训练模块后,首先看到可用词书列表
- **展示内容**:
  - 词书名称
  - 词书描述
  - 单词总数
  - 已学习单词数
  - 学习进度百分比
  - 词书封面图标
  - 词书分类标签(如:四级、六级、考研、托福等)
- **交互方式**:
  - 点击词书卡片进入该词书的学习界面
  - 支持搜索词书
  - 支持按分类筛选
  - 支持按学习进度排序

#### 2.1.2 词书详情
- **需求描述**: 点击词书后显示详细信息
- **展示内容**:
  - 词书完整信息
  - 学习统计(总词数、已学、已掌握、待复习)
  - 学习进度条
  - 单词预览(前10个单词)
  - 操作按钮(开始学习、继续学习、复习)

### 2.2 单词学习功能

#### 2.2.1 学习模式
- **新词学习模式**:
  - 展示用户未学习过的单词
  - 每次学习20个新词(可配置)
  - 采用选择题形式测试
  
- **复习模式**:
  - 展示需要复习的单词(根据遗忘曲线)
  - 优先复习即将遗忘的单词
  - 采用选择题形式测试

- **随机练习模式**:
  - 从词书中随机抽取单词
  - 适合巩固练习

#### 2.2.2 单词展示
- **展示内容**:
  - 单词拼写(大号字体)
  - 音标(国际音标)
  - 词性和中文释义
  - 发音按钮
  - 进度指示器(当前题号/总题数)
  - 得分显示

#### 2.2.3 单词发音
- **需求描述**: 点击发音按钮播放单词读音
- **技术要求**:
  - 使用在线TTS服务(有道词典API)
  - 支持美式发音和英式发音切换
  - 播放时按钮状态变化(禁用、半透明)
  - 播放完成后恢复按钮状态
  - 错误处理(网络异常、发音不可用)

#### 2.2.4 答题交互
- **选项展示**:
  - 4个选项(A、B、C、D)
  - 选项内容为中文释义
  - 选项随机排列
  - 只有一个正确答案

- **答题流程**:
  1. 用户点击选项
  2. 禁用所有选项按钮
  3. 高亮显示用户选择(蓝色)
  4. 高亮显示正确答案(绿色)
  5. 如果答错,高亮错误选项(红色)
  6. 显示结果提示(正确/错误图标和文字)
  7. 显示"下一题"按钮
  8. 更新得分和统计

- **判分逻辑**:
  - 答对: +10分,正确计数+1
  - 答错: 不扣分,错误计数+1,记录到错题本

#### 2.2.5 学习进度
- **进度条显示**:
  - 顶部显示进度条
  - 显示当前题号/总题数
  - 进度百分比
  - 当前得分

- **完成界面**:
  - 显示学习统计(总题数、正确数、错误数、正确率、得分)
  - 显示学习时长
  - 操作按钮(重新开始、返回词书列表、查看错题)

### 2.3 学习记录功能

#### 2.3.1 单词学习进度
- **需求描述**: 记录每个单词的学习状态
- **记录内容**:
  - 单词ID
  - 词书ID
  - 学习状态(未学习、学习中、已掌握)
  - 熟练度(0-100)
  - 学习次数
  - 正确次数
  - 错误次数
  - 最后学习时间
  - 下次复习时间(根据遗忘曲线计算)

#### 2.3.2 错题记录
- **需求描述**: 记录用户答错的题目
- **记录内容**:
  - 单词信息
  - 用户选择的错误答案
  - 正确答案
  - 错误时间
  - 错误次数

#### 2.3.3 学习统计
- **需求描述**: 统计用户的学习数据
- **统计维度**:
  - 按词书统计(每个词书的学习进度)
  - 按日期统计(每日学习单词数、正确率)
  - 按时间段统计(本周、本月学习数据)
  - 总体统计(累计学习单词数、累计学习时长)

### 2.4 任务集成功能

#### 2.4.1 今日任务集成
- **需求描述**: 词汇训练与今日任务系统集成
- **集成方式**:
  - 每答对一题,任务进度+1
  - 使用统一的任务类型: `vocabulary_training`
  - 任务目标可配置(如:学习20个单词)
  - 达到目标自动标记任务完成
  - 支持任务进度实时更新

#### 2.4.2 学习计划集成
- **需求描述**: 词汇训练与学习计划系统集成
- **集成方式**:
  - 学习计划可以包含词汇训练任务
  - 任务描述示例:"学习《四级核心词汇》20个单词"
  - 任务完成后更新学习计划进度
  - 支持计划统计和报告

### 2.5 数据同步功能

#### 2.5.1 实时同步
- **需求描述**: 学习数据实时保存到数据库
- **同步时机**:
  - 每答完一题立即保存
  - 学习完成时保存总体统计
  - 退出时保存当前进度

#### 2.5.2 离线支持
- **需求描述**: 支持离线学习
- **实现方式**:
  - 词书数据预加载到本地数据库
  - 学习记录先保存到本地
  - 有网络时同步到云端(如果有云端功能)

## 3. 非功能需求

### 3.1 性能要求
- 词书列表加载时间 < 1秒
- 单词切换响应时间 < 200ms
- 发音播放延迟 < 500ms
- 数据库操作响应时间 < 100ms

### 3.2 用户体验要求
- 界面简洁美观,符合Material Design规范
- 操作流畅,无卡顿
- 反馈及时,有明确的状态提示
- 支持横屏和竖屏
- 支持深色模式

### 3.3 数据安全要求
- 学习数据定期备份
- 数据库操作使用事务保证一致性
- 防止数据丢失

### 3.4 兼容性要求
- 支持Android 7.0及以上版本
- 适配不同屏幕尺寸
- 适配不同分辨率

## 4. 数据需求

### 4.1 数据库表设计需求

#### 4.1.1 词书表 (books)
- id: 词书ID
- name: 词书名称
- description: 词书描述
- category: 词书分类
- level: 难度等级
- word_count: 单词总数
- icon_url: 封面图标URL
- created_at: 创建时间
- updated_at: 更新时间

#### 4.1.2 单词表 (dictionary_words)
- id: 单词ID
- word: 单词拼写
- phonetic: 音标
- meaning: 中文释义
- word_class: 词性
- example: 例句
- translation: 例句翻译
- audio_url: 发音URL

#### 4.1.3 词书-单词关联表 (book_word_relations)
- id: 关联ID
- book_id: 词书ID
- word_id: 单词ID
- word_order: 单词在词书中的顺序
- tag: 分组标签(如:Unit 1)

#### 4.1.4 单词学习进度表 (word_learning_progress)
- id: 记录ID
- user_id: 用户ID
- book_id: 词书ID
- word_id: 单词ID
- status: 学习状态(0=未学习,1=学习中,2=已掌握)
- proficiency: 熟练度(0-100)
- learn_count: 学习次数
- correct_count: 正确次数
- wrong_count: 错误次数
- last_learn_time: 最后学习时间
- next_review_time: 下次复习时间
- created_at: 创建时间
- updated_at: 更新时间

#### 4.1.5 错题记录表 (wrong_questions)
- id: 记录ID
- user_id: 用户ID
- word_id: 单词ID
- user_answer: 用户答案
- correct_answer: 正确答案
- wrong_time: 错误时间
- wrong_count: 错误次数

#### 4.1.6 学习记录表 (study_records)
- id: 记录ID
- user_id: 用户ID
- book_id: 词书ID
- study_date: 学习日期
- word_count: 学习单词数
- correct_count: 正确数
- wrong_count: 错误数
- accuracy: 正确率
- study_duration: 学习时长(秒)
- score: 得分
- created_at: 创建时间

#### 4.1.7 今日任务表 (daily_tasks)
- id: 任务ID
- plan_id: 计划ID
- task_content: 任务内容
- task_category: 任务分类
- is_completed: 是否完成
- action_type: 操作类型(vocabulary_training)
- completion_type: 完成类型(count/simple)
- target_count: 目标数量
- current_progress: 当前进度
- task_date: 任务日期

### 4.2 数据流转需求

#### 4.2.1 学习流程数据流
1. 用户选择词书 → 查询词书信息和单词列表
2. 开始学习 → 查询学习进度,筛选未学习/需复习单词
3. 答题 → 保存答题记录,更新学习进度,更新任务进度
4. 完成学习 → 保存学习记录,更新统计数据

#### 4.2.2 任务同步数据流
1. 答对一题 → 调用 TaskProgressTracker.recordProgress("vocabulary_training", 1)
2. TaskProgressTracker 查询今日任务
3. 更新任务进度
4. 检查是否达到目标
5. 达到目标则标记任务完成

## 5. 界面需求

### 5.1 词书选择界面
- **布局**: RecyclerView网格布局,每行2个词书卡片
- **卡片内容**: 词书图标、名称、单词数、学习进度
- **顶部**: 搜索框、筛选按钮
- **底部**: 导航栏

### 5.2 词书详情界面
- **顶部**: 返回按钮、词书名称
- **内容区**: 
  - 词书信息卡片
  - 学习进度卡片(进度条、统计数据)
  - 操作按钮(开始学习、复习)
  - 单词预览列表

### 5.3 学习界面
- **顶部**: 返回按钮、进度条、得分
- **中部**: 
  - 单词显示区(单词、音标、发音按钮)
  - 选项区(4个选项按钮)
- **底部**: 
  - 结果显示区(正确/错误提示)
  - 下一题按钮

### 5.4 完成界面
- **中部**: 
  - 学习统计卡片(总题数、正确数、错误数、正确率、得分、学习时长)
  - 鼓励文字
- **底部**: 
  - 重新开始按钮
  - 返回词书列表按钮
  - 查看错题按钮

## 6. 约束条件

### 6.1 技术约束
- 使用Android原生开发
- 使用Room数据库
- 使用MVVM架构
- 使用LiveData进行数据观察

### 6.2 业务约束
- 所有词汇学习功能必须在词汇训练模块中进行
- 不允许在其他模块直接进行词汇学习
- 任务类型统一使用 `vocabulary_training`

### 6.3 时间约束
- 项目分阶段实施
- 每个阶段完成后进行测试
- 确保功能稳定后再进入下一阶段

## 7. 验收标准

### 7.1 功能验收
- ✅ 用户可以浏览和选择词书
- ✅ 用户可以进行单词学习和测试
- ✅ 单词发音正常播放
- ✅ 答题逻辑正确,判分准确
- ✅ 学习进度正确保存和显示
- ✅ 任务进度正确同步
- ✅ 错题正确记录

### 7.2 性能验收
- ✅ 界面流畅,无卡顿
- ✅ 数据加载快速
- ✅ 发音播放流畅

### 7.3 用户体验验收
- ✅ 界面美观,操作直观
- ✅ 反馈及时,提示清晰
- ✅ 无明显bug

## 8. 风险评估

### 8.1 技术风险
- **风险**: 数据库迁移可能导致数据丢失
- **应对**: 做好数据备份,分步迁移,充分测试

### 8.2 兼容性风险
- **风险**: 与现有模块集成可能出现冲突
- **应对**: 详细的设计文档,充分的集成测试

### 8.3 性能风险
- **风险**: 大量数据可能影响性能
- **应对**: 分页加载,数据缓存,性能优化

## 9. 后续扩展

### 9.1 可能的扩展功能
- 单词收藏功能
- 单词笔记功能
- 学习提醒功能
- 学习排行榜
- 社交分享功能
- 自定义词书功能
- 单词拼写练习
- 听力练习

### 9.2 扩展方向
- 支持更多语言
- 支持离线词典
- 支持语音识别
- 支持AI智能推荐
