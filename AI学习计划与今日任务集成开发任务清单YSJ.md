# AI学习计划与今日任务集成开发任务清单YSJ

## 文档控制信息

### 基本信息

| 项目 | 内容 |
|------|------|
| 文档名称 | AI学习计划与今日任务集成开发任务清单 |
| 文档编号 | TASK-2024-001-YSJ |
| 版本号 | v2.0 |
| 创建日期 | 2024-12-17 |
| 最后更新 | 2024-12-17 |
| 开发周期 | 8天 (2024-12-18 ~ 2024-12-25) |
| 任务总数 | 30个 |
| 关联文档 | REQ-2024-001-YSJ, DES-2024-001-YSJ |

### 项目概览

| 项目 | 数据 |
|------|------|
| 总任务数 | 30个 |
| 高优先级任务 | 20个 (67%) |
| 中优先级任务 | 8个 (27%) |
| 低优先级任务 | 2个 (6%) |
| 预计总工时 | 64小时 (8人天) |
| 关键路径任务 | 15个 |

### 人员分工

| 角色 | 姓名 | 负责阶段 | 工作量 |
|------|------|----------|----------|
| 核心开发者 | 开发人员A | 阶段1-3 | 5天 |
| 辅助开发者 | 开发人员B | 阶段2-4 | 4天 |
| 测试工程师 | 测试人员 | 阶段4 | 2天 |
| 代码审查员 | 技术负责人 | 全阶段 | 1天 |

---

## 一、任务依赖关系图

```
阶段1: 数据模型扩展
[Task 1.1] --> [Task 1.2] --> [Task 1.3] --> [Task 1.4]
    |            |            |
    v            v            v
阶段2: 核心功能开发
[Task 2.1] --> [Task 2.2] --> [Task 2.3] --> [Task 2.4] --> [Task 2.5]
    |                                                          |
    v                                                          v
[Task 2.6] --> [Task 2.7] --> [Task 2.8] --> [Task 2.9]      |
    |                                      |                   |
    v                                      v                   v
[Task 2.10] <------------------------------------ [Task 2.11] --> [Task 2.12]
    |
    v
阶段3: 任务模块改造
[Task 3.1] --> [Task 3.2] --> [Task 3.3] --> [Task 3.4] --> [Task 3.5]
    |                                                          |
    v                                                          v
[Task 3.6] --> [Task 3.7] --> [Task 3.8] --> [Task 3.9] --> [Task 3.10]
    |                                                          |
    v                                                          v
[Task 3.11] --> [Task 3.12]                                   |
    |                                                          |
    v                                                          v
阶段4: 测试与优化
[Task 4.1] --> [Task 4.4]
[Task 4.2] --> [Task 4.4]
[Task 4.3] --> [Task 4.4] --> [Task 4.5] --> [Task 4.10]
                              |
                              v
                         [Task 4.6] --> [Task 4.7] --> [Task 4.8] --> [Task 4.9]
```

### 关键路径（Critical Path）

```
1.1 -> 1.2 -> 1.3 -> 2.1 -> 2.2 -> 2.3 -> 2.4 -> 2.5 -> 2.9 -> 2.10 -> 3.5 -> 3.10 -> 4.4 -> 4.10
```

**关键路径总时长**：48小时 (6天)

---

## 二、风险评估矩阵

### 2.1 风险识别与分级

| 风险ID | 风险描述 | 概率 | 影响 | 风险等级 | 应对策略 | 负责人 |
|--------|----------|------|------|----------|----------|--------|
| R-001 | AI生成格式不一致 | 中 | 高 | 高 | 添加格式验证和容错处理 | 开发A |
| R-002 | 数据库迁移失败 | 低 | 高 | 中 | 充分测试迁移脚本，备份数据 | 开发A |
| R-003 | 任务重复生成 | 中 | 中 | 中 | 实现智能去重算法 | 开发B |
| R-004 | 性能不达标 | 低 | 中 | 低 | 添加索引和缓存机制 | 开发B |
| R-005 | 开发进度延误 | 中 | 中 | 中 | 每日站会，及时调整计划 | PM |
| R-006 | 需求变更 | 低 | 高 | 中 | 冻结需求，变更控制流程 | PM |
| R-007 | 集成测试失败 | 中 | 中 | 中 | 充分的单元测试，持续集成 | 测试 |
| R-008 | 第三方API不稳定 | 低 | 中 | 低 | 添加重试机制和超时处理 | 开发A |

### 2.2 风险矩阵图

```
影响
高 |  R-001  R-006  |              |
    |  R-002         |              |
中 |  R-003  R-005  |  R-004       |
    |  R-007  R-008  |              |
低 |                |              |
    +----------------+--------------+
       低            中           高
                  概率
```

### 2.3 风险监控计划

| 风险ID | 监控指标 | 监控频率 | 触发条件 | 升级策略 |
|--------|----------|----------|----------|----------|
| R-001 | AI响应格式错误率 | 每日 | 错误率>10% | 优化Prompt设计 |
| R-002 | 数据库迁移成功率 | 每次迁移 | 失败 | 回滚并修复 |
| R-003 | 重复任务比例 | 每日 | 比例>5% | 调整去重阈值 |
| R-005 | 开发进度 | 每日 | 延误>1天 | 增加人力投入 |

---

## 三、资源分配表

### 3.1 人力资源分配

| 阶段 | 任务数 | 开发A | 开发B | 测试 | 审查 | 总工时 |
|------|--------|--------|--------|------|------|----------|
| 阶段1 | 4 | 4h | 1h | - | 0.5h | 5.5h |
| 阶段2 | 12 | 15h | 8h | - | 2h | 25h |
| 阶段3 | 12 | 10h | 12h | - | 2h | 24h |
| 阶段4 | 10 | 3h | 2h | 8h | 3h | 16h |
| **总计** | **30** | **32h** | **23h** | **8h** | **7.5h** | **70.5h** |

### 3.2 设备资源需求

| 资源类型 | 数量 | 配置要求 | 使用阶段 |
|----------|------|----------|----------|
| 开发机 | 2台 | Android Studio, 8GB RAM | 全阶段 |
| 测试设备 | 3台 | Android 7.0+ | 阶段4 |
| 数据库服务器 | 1台 | SQLite | 全阶段 |
| API测试账号 | 1个 | 智谱AI API Key | 阶段2-4 |

### 3.3 成本预算

| 项目 | 数量 | 单价 | 总价 | 备注 |
|------|------|------|------|------|
| 人力成本 | 70.5h | - | - | 内部人力 |
| API调用费用 | 1000次 | 免费 | ¥0 | glm-4-flash免费 |
| 测试设备 | 3台 | - | ¥0 | 使用现有设备 |
| **总计** | - | - | **¥0** | 无额外成本 |

---

## 四、甘特图（Gantt Chart）

```
任务名称                    Day1  Day2  Day3  Day4  Day5  Day6  Day7  Day8
阶段1: 数据模型扩展
Task 1.1-1.4            ████

阶段2: 核心功能开发
Task 2.1-2.5                  ████████
Task 2.6-2.9                        ██████
Task 2.10-2.12                            ████

阶段3: 任务模块改造
Task 3.1-3.5                                  ██████
Task 3.6-3.10                                       ██████
Task 3.11-3.12                                            ██

阶段4: 测试与优化
Task 4.1-4.3                                                ████
Task 4.4-4.5                                                    ████
Task 4.6-4.10                                                       ████

里程碑
◆ 数据模型完成        ◆
◆ 核心功能完成                    ◆
◆ 任务模块完成                              ◆
◆ 测试通过                                          ◆
```

### 里程碑详情

| 里程碑ID | 里程碑名称 | 计划日期 | 交付物 | 验收标准 |
|----------|----------|----------|--------|----------|
| M1 | 数据模型完成 | Day 1 | 数据模型类、数据库迁移脚本 | 编译通过，数据库升级成功 |
| M2 | 核心功能完成 | Day 4 | StudyPlanExtractor、Repository、AIChatActivity | 计划生成成功率>95% |
| M3 | 任务模块完成 | Day 6 | TaskGenerationService、DailyTaskActivity | 任务展示正常，无重复 |
| M4 | 测试通过 | Day 8 | 测试报告、代码审查报告 | 所有验收标准通过 |

---

## 阶段一：数据模型扩展（1天）

### Task 1.1：创建StructuredPlanResult数据模型
- **优先级**：高 | **时间**：2小时
- **内容**：创建完整的结构化计划结果类，包含Phase和TaskTemplate内部类

### Task 1.2：扩展DailyTaskEntity实体
- **优先级**：高 | **时间**：1.5小时
- **内容**：添加taskType、source、planTitle、phaseName字段

### Task 1.3：更新数据库版本和迁移
- **优先级**：高 | **时间**：1小时
- **内容**：升级数据库版本，创建迁移脚本

### Task 1.4：创建数据库索引
- **优先级**：中 | **时间**：0.5小时
- **内容**：为daily_tasks表添加3个索引

---

## 阶段二：核心功能开发（3天）

### Task 2.1：增强StudyPlanExtractor - 构建Prompt
- **优先级**：高 | **时间**：2小时
- **内容**：设计增强的结构化Prompt，包含完整JSON示例

### Task 2.2：增强StudyPlanExtractor - 解析响应
- **优先级**：高 | **时间**：3小时
- **内容**：实现JSON提取和解析逻辑，计算统计信息

### Task 2.3：增强StudyPlanExtractor - 数据验证
- **优先级**：高 | **时间**：2小时
- **内容**：验证计划数据完整性，包含详细日志

### Task 2.4：增强StudyPlanExtractor - 日期计算
- **优先级**：高 | **时间**：1.5小时
- **内容**：计算计划和阶段的开始结束日期

### Task 2.5：增强StudyPlanExtractor - 集成方法
- **优先级**：高 | **时间**：2小时
- **内容**：集成完整流程，添加进度回调

### Task 2.6：扩展StudyPlanRepository - 数据转换
- **优先级**：高 | **时间**：1.5小时
- **内容**：将StructuredPlanResult转换为StudyPlanEntity

### Task 2.7：扩展StudyPlanRepository - 保存阶段
- **优先级**：高 | **时间**：2小时
- **内容**：保存学习阶段到数据库

### Task 2.8：扩展StudyPlanRepository - 保存任务模板
- **优先级**：高 | **时间**：2小时
- **内容**：保存任务模板到数据库（不设置date）

### Task 2.9：扩展StudyPlanRepository - 事务保存
- **优先级**：高 | **时间**：2.5小时
- **内容**：使用事务保存完整计划结构

### Task 2.10：修改AIChatActivity - 集成生成流程
- **优先级**：高 | **时间**：3小时
- **内容**：集成计划生成、保存、任务生成完整流程

### Task 2.11：修改AIChatActivity - 生成今日任务
- **优先级**：高 | **时间**：2小时
- **内容**：调用TaskGenerationService生成今日任务

### Task 2.12：修改AIChatActivity - 成功对话框
- **优先级**：中 | **时间**：1.5小时
- **内容**：显示计划生成成功对话框，支持跳转

---

## 阶段三：任务模块改造（2天）

### Task 3.1：增强TaskGenerationService - 获取当前阶段
- **优先级**：高 | **时间**：2小时
- **内容**：根据日期判断当前学习阶段

### Task 3.2：增强TaskGenerationService - 获取任务模板
- **优先级**：高 | **时间**：1.5小时
- **内容**：查询指定阶段的任务模板

### Task 3.3：增强TaskGenerationService - 相似度计算
- **优先级**：中 | **时间**：2小时
- **内容**：实现Levenshtein距离算法

### Task 3.4：增强TaskGenerationService - 任务去重
- **优先级**：中 | **时间**：1.5小时
- **内容**：检查任务相似度，去除重复任务

### Task 3.5：增强TaskGenerationService - 增强生成方法
- **优先级**：高 | **时间**：3小时
- **内容**：实现幂等的今日任务生成方法

### Task 3.6：改造DailyTaskActivity - 初始化服务
- **优先级**：高 | **时间**：1小时
- **内容**：初始化Repository和Service

### Task 3.7：改造DailyTaskActivity - 加载今日任务
- **优先级**：高 | **时间**：2.5小时
- **内容**：查询活跃计划并加载任务

### Task 3.8：改造DailyTaskActivity - 加载多计划任务
- **优先级**：高 | **时间**：3小时
- **内容**：合并多个计划的今日任务

### Task 3.9：改造DailyTaskActivity - 更新UI
- **优先级**：高 | **时间**：2小时
- **内容**：更新RecyclerView和进度条

### Task 3.10：改造DailyTaskActivity - 更新任务状态
- **优先级**：高 | **时间**：2小时
- **内容**：保存任务完成状态到数据库

### Task 3.11：更新DailyTaskAdapter - 显示任务来源
- **优先级**：中 | **时间**：2小时
- **内容**：显示任务来自哪个学习计划

### Task 3.12：更新DailyTaskAdapter - 更新布局文件
- **优先级**：中 | **时间**：1.5小时
- **内容**：添加任务来源TextView到布局

---

## 阶段四：测试与优化（2天）

### Task 4.1：编写StudyPlanExtractor单元测试
- **优先级**：中 | **时间**：3小时
- **内容**：测试计划提取的各个方法

### Task 4.2：编写TaskGenerationService单元测试
- **优先级**：中 | **时间**：3小时
- **内容**：测试任务生成和去重逻辑

### Task 4.3：编写StudyPlanRepository单元测试
- **优先级**：中 | **时间**：2小时
- **内容**：测试数据保存和查询方法

### Task 4.4：集成测试 - 完整流程
- **优先级**：高 | **时间**：3小时
- **内容**：测试从对话到任务展示的完整流程

### Task 4.5：性能测试 - 大数据量
- **优先级**：中 | **时间**：2小时
- **内容**：测试100个任务的加载性能

### Task 4.6：优化数据库查询
- **优先级**：低 | **时间**：2小时
- **内容**：优化SQL查询，添加必要的索引

### Task 4.7：添加缓存机制
- **优先级**：低 | **时间**：2小时
- **内容**：缓存查询结果，减少数据库访问

### Task 4.8：代码审查和重构
- **优先级**：中 | **时间**：3小时
- **内容**：代码审查，重构不合理的代码

### Task 4.9：编写开发文档
- **优先级**：低 | **时间**：2小时
- **内容**：编写代码注释和开发文档

### Task 4.10：最终验收测试
- **优先级**：高 | **时间**：3小时
- **内容**：按照验收标准进行最终测试

---

## 验收标准

- [ ] AI生成的学习计划能正确保存到数据库
- [ ] 计划保存后自动生成今日任务
- [ ] 今日任务页面正确显示所有活跃计划的任务
- [ ] 任务完成状态能正确更新
- [ ] 无重复任务生成
- [ ] 性能测试通过（100个任务加载<1秒）
- [ ] 单元测试覆盖率>80%
- [ ] 集成测试通过
- [ ] 代码审查通过

---

**任务清单结束**
